<!DOCTYPE html><html lang="en-us" >

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=4321&amp;path=livereload" data-no-instant defer></script>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="James E. Pustejovsky">

  
  
  
    
  
  <meta name="description" content="A while back, I wrote up formulas for the sampling covariances between standardized mean differences that are calculated from multi-arm experiments, including experiments with multiple outcomes. Along with the sampling variances of effect size estimates, the covariances are also needed for conducting a meta-analysis of dependent effect size data.">

  
  <link rel="alternate" hreflang="en-us" href="http://localhost:4321/computing-covariance-matrices/">

  


  
  
  
  <meta name="theme-color" content="#3f51b5">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  




  


  
  

  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="http://localhost:4321/computing-covariance-matrices/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@jepusto">
  <meta property="twitter:creator" content="@jepusto">
  
  <meta property="og:site_name" content="James E. Pustejovsky">
  <meta property="og:url" content="http://localhost:4321/computing-covariance-matrices/">
  <meta property="og:title" content="Computing covariance matrices for meta-analysis of dependent effect size estimates | James E. Pustejovsky">
  <meta property="og:description" content="A while back, I wrote up formulas for the sampling covariances between standardized mean differences that are calculated from multi-arm experiments, including experiments with multiple outcomes. Along with the sampling variances of effect size estimates, the covariances are also needed for conducting a meta-analysis of dependent effect size data."><meta property="og:image" content="http://localhost:4321/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png">
  <meta property="twitter:image" content="http://localhost:4321/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2024-05-18T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2024-05-18T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:4321/computing-covariance-matrices/"
  },
  "headline": "Computing covariance matrices for meta-analysis of dependent effect size estimates",
  
  "datePublished": "2024-05-18T00:00:00Z",
  "dateModified": "2024-05-18T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "James E. Pustejovsky"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "James E. Pustejovsky",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:4321/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "A while back, I wrote up formulas for the sampling covariances between standardized mean differences that are calculated from multi-arm experiments, including experiments with multiple outcomes. Along with the sampling variances of effect size estimates, the covariances are also needed for conducting a meta-analysis of dependent effect size data."
}
</script>

  

  


  


  
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <link rel="stylesheet" href="/css/codefolding.css" />



  <title>Computing covariance matrices for meta-analysis of dependent effect size estimates | James E. Pustejovsky</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">James E. Pustejovsky</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">James E. Pustejovsky</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/files/Pustejovsky-CV.pdf"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#working-papers"><span>Working papers</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/publication/"><span>Publications</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/talk/"><span>Presentations</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#software"><span>Software</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>Students</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags"><span>Topics</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>Computing covariance matrices for meta-analysis of dependent effect size estimates</h1>

  

  
    

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>



    


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/authors/admin/">James E. Pustejovsky</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    2024-05-18
  </span>
  

  

  

  
  
  
  <span class="middot-divider"></span>
  <a href="/computing-covariance-matrices/#disqus_thread"></a>
  

  
  

</div>

    














  
</div>



  <div class="article-container">

    <div class="article-style">
      


<p><a href="/correlations-between-SMDs/">A while back</a>, I wrote up formulas for the sampling covariances between standardized mean differences that are calculated from multi-arm experiments, including experiments with multiple outcomes. Along with the sampling variances of effect size estimates, the covariances are also needed for conducting a meta-analysis of dependent effect size data. However, it’s often hard to get all the information you need to actually apply the formulas in practice, and so we end up relying on simplified, rough approximations (and sensitivity analysis) for the covariance terms. A few years after the post above, <a href="/imputing-covariance-matrices-for-multi-variate-meta-analysis/">I sketched out some functions</a> for building these sort of quick-and-dirty covariance matrices, and eventually added them to the <code>clubSandwich package</code> as <code>impute_covariance_matrix()</code> and <code>pattern_covariance_matrix()</code>. Although they’re certainly convenient, and can handle situations where you’d like to assume different correlations for different pairs of outcomes, the covariance matrices you can generate with these functions don’t really handle the situation where you’ve got effect size estimates from multi-arm experiments.</p>
<p>Then a few years ago, Wolfgang Viechtbauer added a function called <code>vcalc()</code> to the <code>metafor</code> package, which does everything that <code>impute_covariance_matrix()</code> and <code>pattern_covariance_matrix()</code> can do, but with even more features and nuance. The <code>vcalc()</code> doesn’t implement the exact formulas for covariances between standardized mean differences, but it does implement a close approximation that also generalizes readily to other effect size metrics. Consequently, I think it’s really time to retire (or at least deprecate) the clubSandwich functions. To mark the occasion (and hopefully encourage users of <code>clubSandwich::impute_covariance_matrix()</code> to make the switch), I’m going to use this post to demonstrate some of the nice features of <code>metafor::vcalc()</code>.</p>
<div id="multi-arm-trials" class="section level2">
<h2>Multi-arm trials</h2>
<p>Here’s a little made-up dataset with data from two samples, where sample 1 has three treatment arms and sample 2 has two treatment arms:</p>
<pre class="r"><code>A_dat &lt;- data.frame(
  sampleID = rep(c(1,2), times = c(3,2)),
  arm_T = c(&quot;T&quot;,&quot;U&quot;,&quot;V&quot;,&quot;T&quot;,&quot;V&quot;),
  n_T = c(23, 70, 58, 37, 15),
  m_T = c(3.3, 2.5, 1.9, 10.7, 12.4),
  sd_T = c(1.9, 1.8, 1.7, 3.4, 3.7),
  arm_C = rep(&quot;C&quot;,5),
  n_C = rep(c(61, 33), times = c(3,2)),
  m_C = rep(c(2.1, 10.2), times = c(3,2)),
  sd_C = rep(c(1.7, 3.5), times = c(3,2))
)</code></pre>
<p>We can compute effect size estimates<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> and variances from the summary statistics as follows:</p>
<pre class="r"><code>library(metafor)</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: metadat</code></pre>
<pre><code>## Loading required package: numDeriv</code></pre>
<pre><code>## 
## Loading the &#39;metafor&#39; package (version 4.4-0). For an
## introduction to the package please type: help(metafor)</code></pre>
<pre class="r"><code>A_dat &lt;- escalc(
  data = A_dat, measure = &quot;SMD&quot;,
  n1i = n_T, n2i = n_C,
  m1i = m_T, m2i = m_C,
  sd1i = sd_T, sd2i = sd_C
)

A_dat</code></pre>
<pre><code>## 
##   sampleID arm_T n_T  m_T sd_T arm_C n_C  m_C sd_C      yi     vi 
## 1        1     T  23  3.3  1.9     C  61  2.1  1.7  0.6771 0.0626 
## 2        1     U  70  2.5  1.8     C  61  2.1  1.7  0.2267 0.0309 
## 3        1     V  58  1.9  1.7     C  61  2.1  1.7 -0.1169 0.0337 
## 4        2     T  37 10.7  3.4     C  33 10.2  3.5  0.1434 0.0575 
## 5        2     V  15 12.4  3.7     C  33 10.2  3.5  0.6075 0.1008</code></pre>
<p>Using <code>impute_covariance_matrix()</code> on this dataset will return a set of covariance matrices for each sample, where there is a constant correlation between pairs of effect sizes from the same study (here I use a correlation of 0.7):</p>
<pre class="r"><code>library(clubSandwich)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;clubSandwich&#39;:
##   method    from    
##   bread.mlm sandwich</code></pre>
<pre class="r"><code>V_icm &lt;- with(A_dat, 
  impute_covariance_matrix(
    vi = vi,
    cluster = sampleID,
    r = 0.7
  )
)

V_icm</code></pre>
<pre><code>## $`1`
##            [,1]       [,2]       [,3]
## [1,] 0.06260097 0.03077473 0.03214796
## [2,] 0.03077473 0.03087531 0.02257712
## [3,] 0.03214796 0.02257712 0.03369223
## 
## $`2`
##            [,1]       [,2]
## [1,] 0.05747700 0.05328503
## [2,] 0.05328503 0.10081386</code></pre>
<pre class="r"><code>lapply(V_icm, cov2cor)</code></pre>
<pre><code>## $`1`
##      [,1] [,2] [,3]
## [1,]  1.0  0.7  0.7
## [2,]  0.7  1.0  0.7
## [3,]  0.7  0.7  1.0
## 
## $`2`
##      [,1] [,2]
## [1,]  1.0  0.7
## [2,]  0.7  1.0</code></pre>
<p>That degree of correlation isn’t really right—it’s too high, for one, and it shouldn’t be constant across all three pairs of effects from study 1 because the treatment groups have different sample sizes. In fact, the covariances among these effects can be <a href="/correlations-between-SMDs/">calculated based on the available information</a>, without the need to impute anything. A closer approximation is possible with <code>vcalc()</code>.</p>
<p>To use <code>vcalc()</code>, we’ll need to provide a bit of additional information about the structure of the arms within each study (in the arguments <code>grp1</code> and <code>grp2</code>) and the sample sizes of each arm (in the arguments <code>w1</code> and <code>w2</code>):</p>
<pre class="r"><code>V_vcalc &lt;- vcalc(
  data = A_dat,         # dataset
  vi = vi,              # sampling variances
  cluster = sampleID,   # identifier for each unique sample
  grp1 = arm_T,         # identifier for unique treatment arms
  w1 = n_T,             # effective sample size of each treatment arm
  grp2 = arm_C,         # identifier for unique contro arms
  w2 = n_C,             # effective sample size of each control arm
  sparse = TRUE         # return a sparse matrix
)

# look at the blocks for each sample
blsplit(V_vcalc, A_dat$sampleID) </code></pre>
<pre><code>## $`1`
## 3 x 3 sparse Matrix of class &quot;dgCMatrix&quot;
##                                      
## [1,] 0.06260097 0.01681643 0.01677723
## [2,] 0.01681643 0.03087531 0.01645979
## [3,] 0.01677723 0.01645979 0.03369223
## 
## $`2`
## 2 x 2 sparse Matrix of class &quot;dgCMatrix&quot;
##                           
## [1,] 0.05747700 0.03093741
## [2,] 0.03093741 0.10081386</code></pre>
<p>These covariances have smaller correlations between effect sizes for different arms (closer to 0.5 or less):</p>
<pre class="r"><code>blsplit(V_vcalc, A_dat$sampleID) |&gt; 
  lapply(cov2cor)</code></pre>
<pre><code>## $`1`
## 3 x 3 sparse Matrix of class &quot;dsCMatrix&quot;
##                                   
## [1,] 1.0000000 0.3825055 0.3653127
## [2,] 0.3825055 1.0000000 0.5103333
## [3,] 0.3653127 0.5103333 1.0000000
## 
## $`2`
## 2 x 2 sparse Matrix of class &quot;dsCMatrix&quot;
##                         
## [1,] 1.0000000 0.4064217
## [2,] 0.4064217 1.0000000</code></pre>
<p>What’s going on here? The code inside <code>metafor::vcalc()</code> contains one of the hairiest messes of <code>ifelse</code> statements I’ve ever encountered, but I think the gist of it is that the covariance terms are calculated differently depending on whether different rows within a cluster share the same <code>grp1</code> or <code>grp2</code> identifier. Say that study <span class="math inline">\(j\)</span> has <span class="math inline">\(k_j\)</span> effect sizes, indexed by <span class="math inline">\(i=1,...,k_j\)</span>, that the covariance between effects <span class="math inline">\(h\)</span> and <span class="math inline">\(i\)</span> is <span class="math inline">\(V_{hi,j}\)</span>, that the weights corresponding to effect <span class="math inline">\(i\)</span> are <span class="math inline">\(\eta_{1ij}\)</span> and <span class="math inline">\(\eta_{2ij}\)</span>, and that the group identifiers are <span class="math inline">\(g_{1ij}\)</span> and <span class="math inline">\(g_{2ij}\)</span>. Assuming that the set of <code>grp1</code> identifiers does not overlap with the set of <code>grp2</code> identifiers, then the covariance between effect sizes <span class="math inline">\(h\)</span> and <span class="math inline">\(i\)</span> in study <span class="math inline">\(j\)</span> is taken to be
<span class="math display">\[
V_{hi,j} = \left(I(g_{1hj} = g_{1ij}) \sqrt{\frac{\frac{1}{\eta_{1hj}}}{\frac{1}{\eta_{1hj}} + \frac{1}{\eta_{2hj}}} \times \frac{\frac{1}{\eta_{1ij}}}{\frac{1}{\eta_{1ij}} + \frac{1}{\eta_{2ij}}}} + I(g_{2hj} = g_{2ij}) \sqrt{\frac{\frac{1}{\eta_{2hj}}}{\frac{1}{\eta_{2hj}} + \frac{1}{\eta_{2hj}}} \times \frac{\frac{1}{\eta_{1ij}}}{\frac{1}{\eta_{1ij}} + \frac{1}{\eta_{2ij}}}}\right) \times \sqrt{V_{hh,j}  V_{ii,j}}.
\]</span>
For many effect size metrics, the sampling variance has a form like
<span class="math inline">\(V_{ii,j} = \frac{\sigma_{1ij}}{\eta_{1ij}} + \frac{\sigma_{2ij}{\eta_{2ij}}\)</span>, and so the covariance formula above will effectively pull off the part of the sampling variance that corresponds to a group shared in common by effect sizes <span class="math inline">\(h\)</span> and <span class="math inline">\(i\)</span>, and will end up reducing to the sampling variance when <span class="math inline">\(h = i\)</span>.</p>
<p>The formula for the sampling variance of a standardized mean difference (based on a simple comparison of group means) is
<span class="math display">\[\text{Var}(d_{ij}) \approx V_{ii,j} = \frac{1}{n_{C,ij}} + \frac{1}{n_{T,ij}} + \frac{d_{ij}^2}{2 \nu},\]</span>
where <span class="math inline">\(n_{C,ij}\)</span> and <span class="math inline">\(n_{T,ij}\)</span> are the sample sizes in the two groups being compared and <span class="math inline">\(\nu\)</span> is the degrees of freedom of the denominator standard deviation. This doesn’t exactly have the proportional form above, but unless <span class="math inline">\(\nu\)</span> is really small, <span class="math inline">\(V_{ii,j}\)</span> is going to be very close to <span class="math inline">\(\frac{1}{n_{C,ij}} + \frac{1}{n_{T,ij}}\)</span>. Taking <span class="math inline">\(\eta_{1,ij} = n_{T,ij}\)</span> and <span class="math inline">\(\eta_{2,ij} = n_{C,ij}\)</span>, the covariance formula implemented in <code>vcalc</code> ends up giving something quite close to
<span class="math display">\[V_{hi,j} \approx \frac{I(g_{2hj} = g_{2ij})}{n_{C,ij}} + \frac{I(g_{1hj} = g_{1ij})}{n_{T,ij}}.\]</span>
Since the covariance formulas I reviewed in my old post are approximations anyways, this further simplification seems pretty much okay.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Readers might note that the standardized mean differences calculated here are from multi-arm trials, but the effects are calculated using denominator standard deviations that only pool across pairs of arms, rather than across <em>all</em> arms in the sample. The latter is usually better (because it keeps the scaling of the outcome constant across all the effects from the sample), but I’m too lazy to handle this particular wrinkle right now.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/effect-size/">effect size</a>
  
  <a class="badge badge-light" href="/tags/distribution-theory/">distribution theory</a>
  
  <a class="badge badge-light" href="/tags/meta-analysis/">meta-analysis</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=http://localhost:4321/computing-covariance-matrices/&amp;text=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=http://localhost:4321/computing-covariance-matrices/&amp;t=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates&amp;body=http://localhost:4321/computing-covariance-matrices/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=http://localhost:4321/computing-covariance-matrices/&amp;title=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates%20http://localhost:4321/computing-covariance-matrices/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=http://localhost:4321/computing-covariance-matrices/&amp;title=Computing%20covariance%20matrices%20for%20meta-analysis%20of%20dependent%20effect%20size%20estimates" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>








<section id="comments">
  
    
<div id="disqus_thread"></div>
<script>
  let disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "jepusto" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  
</section>






  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/simulating-correlated-smds/">Simulating correlated standardized mean differences for meta-analysis</a></li>
      
      <li><a href="/variance-of-r-in-two-level-design/">Sampling variance of Pearson r in a two-level design</a></li>
      
      <li><a href="/alternative-formulas-for-the-smd/">Alternative formulas for the standardized mean difference</a></li>
      
      <li><a href="/correlations-between-smds/">Correlations between standardized mean differences</a></li>
      
      <li><a href="/distribution-of-significant-effects/">Distribution of the number of significant effect sizes</a></li>
      
    </ul>
  </div>
  



  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    <script id="dsq-count-scr" src="https://jepusto.disqus.com/count.js" async></script>
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37b744f7fa48882698912f536b972419.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  
  
  
   
  <script>
  $(document).ready(function () {
    window.initializeCodeFolding("show" === "show");
  });
  </script>
  <script src="/js/codefolding.js"></script>



  <p class="powered-by">
    © 2024 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
